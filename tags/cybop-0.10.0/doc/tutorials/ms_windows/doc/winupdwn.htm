<HTML>
<HEAD>
<META NAME="description" CONTENT="Willemers Informatik-Ecke: Windows Programmierung: Up-Down-Control">
<META NAME="author" CONTENT="Arnold Willemer">
<META NAME="keywords" CONTENT="Windows, Programmierung, Up-Down-Control">
<TITLE>Windows-Programmierung: Up-Down-Control
</TITLE>
</HEAD>
<BODY>
<a name="top"><table width=100%><tr><td bgcolor=yellow  align=center>
<H1>Windows Programmierung: Up-Down-Control</H1>
</td></tr></table>
<p><font face="Helvetica" size=3">
<a href="wincontr.htm#top">Einf&uuml;hrende Informationen</a>
 &uuml;ber die Programmierung von Kontrollelementen werden hier vorausgesetzt.
</font><p>

<H2>Allgemein</H2>

Das Up-Down-Control besteht aus zwei mit Pfeilen markierten Buttons.
Es geh&ouml;rt zu den Common Controls.
In C-Programmen ist das Einbinden
der Datei COMMCTRL.H notwendig und die comctl32.lib muss zum Programm gelinkt werden.

<H2>Buddy</H2>

Es wird gern verwendet, um ganze Zahlen nach oben oder unten einzustellen.
In diesem Fall wird ein 
<a href="winedit.htm">Eingabefeld</a> neben das Control gesetzt.
Steuert das Up-Down den Inhalt des Eingabefeld, wird es der 'Buddy' (engl. Kumpel)
des Up-Down genannt.
<p>
Um diesen Automatismus zu erzeugen, legt man ein Eingabefeld an und stellt das
Up-Down daneben. Das Up-Down muss den Stil UDS_AUTOBUDDY bekommen. In dem Moment
steuert es das in Z-Ordnung zuvor liegende Fensterobjekt.
Wird nun noch der Stil UDS_SETBUDDYINT wird der Text dieses Objektes als Integerwert
interpretiert und mit Hilfe der Nachricht WM_SETTEXT inkrementiert bzw. dekrementiert.
<p>
Standardm&auml;&szlig;ig wird durch den Pfeil nach oben dekrementiert(!) und nach unten
erh&ouml;ht.

<H2>Arbeitsbereich festlegen</H2>

Die Grenzen, in denen die Zahlen eingestellt werden k&ouml;nnen, werden wie
im folgenden Beispiel festgelegt. Hier ist die Untergrenze 1 und die Obergrenze 8.
Danach arbeitet der Oben-Pfeil auch erh&ouml;hend.

<p><table border=1 width=100%><tr><td bgcolor=lightblue><pre>
  SendMessage (GetDlgItem(hDlg, IDC_SPINCOLS), UDM_SETRANGE, 0L, MAKELONG (8, 1));
</pre></td></tr></table><p>

hDlg ist das Handle des Dialogs, IDC_SPINCOLS ist die Ressource-ID des Up-Down-Control.


<hr>
<table width=100%>
<tr><td>
<a href="../index.htm">Homepage</a>
 - <a href="winprg.htm">Windows-API-Programmierung</a>
</td><td align=right>
(C) Copyright 2000 <a href="mailto:arnold@willemer.de">Arnold Willemer</a>
</td></tr></table>

</BODY>
</HTML>
